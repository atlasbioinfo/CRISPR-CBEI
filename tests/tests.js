let unittestdemoSeq='ATGACCATGATTACGGATTCACTGGCCGTCGTTTTACAACGTCGTGACTGGGAAAACCCTGGCGTTACCCAACTTAATCGCCTTGCAGCACATCCCCCTTTCGCCAGCTGGCGTAATAGCGAAGAGGCCCGCACCGATCGCCCTTCCCAACAGTTGCGCAGCCTGAATGGCGAATGGCGCTTTGCCTGGTTTCCGGCACCAGAAGCGGTGCCGGAAAGCTGGCTGGAGTGCGATCTTCCTGAGGCCGATACTGTCGTCGTCCCCTCAAACTGGCAGATGCACGGTTACGATGCGCCCATCTACACCAACGTGACCTATCCCATTACGGTCAATCCGCCGTTTGTTCCCACGGAGAATCCGACGGGTTGTTACTCGCTCACATTTAATGTTGATGAAAGCTGGCTACAGGAAGGCCAGACGCGAATTATTTTTGATGGCGTTAACTCGGCGTTTCATCTGTGGTGCAACGGGCGCTGGGTCGGTTACGGCCAGGACAGTCGTTTGCCGTCTGAATTTGACCTGAGCGCATTTTTACGCGCCGGAGAAAACCGCCTCGCGGTGATGGTGCTGCGCTGGAGTGACGGCAGTTATCTGGAAGATCAGGATATGTGGCGGATGAGCGGCATTTTCCGTGACGTCTCGTTGCTGCATAAACCGACTACACAAATCAGCGATTTCCATGTTGCCACTCGCTTTAATGATGATTTCAGCCGCGCTGTACTGGAGGCTGAAGTTCAGATGTGCGGCGAGTTGCGTGACTACCTACGGGTAACAGTTTCTTTATGGCAGGGTGAAACGCAGGTCGCCAGCGGCACCGCGCCTTTCGGCGGTGAAATTATCGATGAGCGTGGTGGTTATGCCGATCGCGTCACACTACGTCTGAACGTCGAAAACCCGAAACTGTGGAGCGCCGAAATCCCGAATCTCTATCGTGCGGTGGTTGAACTGCACACCGCCGACGGCACGCTGATTGAAGCAGAAGCCTGCGATGTCGGTTTCCGCGAGGTGCGGATTGAAAATGGTCTGCTGCTGCTGAACGGCAAGCCGTTGCTGATTCGAGGCGTTAACCGTCACGAGCATCATCCTCTGCATGGTCAGGTCATGGATGAGCAGACGATGGTGCAGGATATCCTGCTGATGAAGCAGAACAACTTTAACGCCGTGCGCTGTTCGCATTATCCGAACCATCCGCTGTGGTACACGCTGTGCGACCGCTACGGCCTGTATGTGGTGGATGAAGCCAATATTGAAACCCACGGCATGGTGCCAATGAATCGTCTGACCGATGATCCGCGCTGGCTACCGGCGATGAGCGAACGCGTAACGCGAATGGTGCAGCGCGATCGTAATCACCCGAGTGTGATCATCTGGTCGCTGGGGAATGAATCAGGCCACGGCGCTAATCACGACGCGCTGTATCGCTGGATCAAATCTGTCGATCCTTCCCGCCCGGTGCAGTATGAAGGCGGCGGAGCCGACACCACGGCCACCGATATTATTTGCCCGATGTACGCGCGCGTGGATGAAGACCAGCCCTTCCCGGCTGTGCCGAAATGGTCCATCAAAAAATGGCTTTCGCTACCTGGAGAGACGCGCCCGCTGATCCTTTGCGAATACGCCCACGCGATGGGTAACAGTCTTGGCGGTTTCGCTAAATACTGGCAGGCGTTTCGTCAGTATCCCCGTTTACAGGGCGGCTTCGTCTGGGACTGGGTGGATCAGTCGCTGATTAAATATGATGAAAACGGCAACCCGTGGTCGGCTTACGGCGGTGATTTTGGCGATACGCCGAACGATCGCCAGTTCTGTATGAACGGTCTGGTCTTTGCCGACCGCACGCCGCATCCAGCGCTGACGGAAGCAAAACACCAGCAGCAGTTTTTCCAGTTCCGTTTATCCGGGCAAACCATCGAAGTGACCAGCGAATACCTGTTCCGTCATAGCGATAACGAGCTCCTGCACTGGATGGTGGCGCTGGATGGTAAGCCGCTGGCAAGCGGTGAAGTGCCTCTGGATGTCGCTCCACAAGGTAAACAGTTGATTGAACTGCCTGAACTACCGCAGCCGGAGAGCGCCGGGCAACTCTGGCTCACAGTACGCGTAGTGCAACCGAACGCGACCGCATGGTCAGAAGCCGGGCACATCAGCGCCTGGCAGCAGTGGCGTCTGGCGGAAAACCTCAGTGTGACGCTCCCCGCCGCGTCCCACGCCATCCCGCATCTGACCACCAGCGAAATGGATTTTTGCATCGAGCTGGGTAATAAGCGTTGGCAATTTAACCGCCAGTCAGGCTTTCTTTCACAGATGTGGATTGGCGATAAAAAACAACTGCTGACGCCGCTGCGCGATCAGTTCACCCGTGCACCGCTGGATAACGACATTGGCGTAAGTGAAGCGACCCGCATTGACCCTAACGCCTGGGTCGAACGCTGGAAGGCGGCGGGCCATTACCAGGCCGAAGCAGCGTTGTTGCAGTGCACGGCAGATACACTTGCTGATGCGGTGCTGATTACGACCGCTCACGCGTGGCAGCATCAGGGGAAAACCTTATTTATCAGCCGGAAAACCTACCGGATTGATGGTAGTGGTCAAATGGCGATTACCGTTGATGTTGAAGTGGCGAGCGATACACCGCATCCGGCGCGGATTGGCCTGAACTGCCAGCTGGCGCAGGTAGCAGAGCGGGTAAACTGGCTCGGATTAGGGCCGCAAGAAAACTATCCCGACCGCCTTACTGCCGCCTGTTTTGACCGCTGGGATCTGCCATTGTCAGACATGTATACCCCGTACGTCTTCCCGAGCGAAAACGGTCTGCGCTGCGGGACGCGCGAATTGAATTATGGCCCACACCAGTGGCGCGGCGACTTCCAGTTCAACATCAGCCGCTACAGTCAACAGCAACTGATGGAAACCAGCCATCGCCATCTGCTGCACGCGGAAGAAGGCACATGGCTGAATATCGACGGTTTCCATATGGGGATTGGTGGCGACGACTCCTGGAGCCCGTCAGTATCGGCGGAATTCCAGCTGAGCGCCGGTCGCTACCATTACCAGTTGGTCTGGTGTCAAAAATAA';
let testFasta='>chrI\nagcttttcattctgactgcaacgggcaatatgtctctgtgtggattaaaaaaagagtgtctgatagcagcttctgaactgTTACGCCAGgaGcCGAAAGGcgggttacctgccgtgagtaaattaaaattttattgacttaggtcactaaatactttaaccaatataggcatagcgcacagacCCACCTTTCGgCtcCTGGCGTAA\nagataaaaattacagagtacacaacatccatgaaacgcattagcaccaccattaccaccaccatcaccattaccacaggt\nTATTACGCCAGCTGGCGAAAaGGggtgcgggctgacgcgtacaggaaacacagaaaaaagcccgcacctgacagtgcgggctttttttttcgaccaaagg\ntaacgaggtaacaaccatgcgagtgttgaagttcggcggtacatcagtggcaaatgcagaacgttttctgcgtgttgccg\natattctggaaagcaatgccaggcaggggcaggtggccaccgtcctctctgcccccgccaaaatcaccaaccacctggtg\ngcgatgattgaaaaaaccattagcggccaggatgctttacccaatatcagcgatgccgaacgtatttttgccgaactttt\ngacgggactcgccgccgcccagccggggttcccgctggcgcaattgaaaactttcgtcgatcaggaatttgcccaaataa\naacatgtcctgcatggcattagtttgttggggcagtgcccggatagcatcaacgctgcgctgatttgccgtggcgagaaa\natgtcgatcgccattatggccggcgtattagaagcgcgcggtcacaacgttactgttatcgatccggtcgaaaaactgct\nggcagtggggcattacctcgaatctaccgtcgatattgctgagtccacccgccgtattgcggcaagccgcattccggctg\natcacatggtgctgatggcaggtttcaccgccggtaatgaaaaaggcgaactggtggtgcttggacgcaacggttccgacCAACtGTTGCGgAGCCTGAAtgg\ntactctgctgcggtgctggctgcctgtttacgcgccgattgttgcgagatttggacggacgttgacggggtctatacctg\ncgacccgcgtcaggtgcccgatgcgaggttgttgaagtcgatgtcctaccaggaagcgatggagctttcctacttcggcg\nctaaagttcttcacccccgcaccattacccccatcgcccagttccagatcccttgcctgattaaaaataccggaaatcct\ncaagcaccaggtacgctcattggtgccagccgtgatgaagacgaattaccggtcaagggcatttccaatctgaataacat\nggcaatgttcagcgtttctggtccggggatgaaagggatggtcggcatggcggcgcgcgtctttgcagcgatgtcacgcg\ncccgtatttccgtggtgctgattacgcaatcatcttccgaatacagcatcagtttctgcgttccacaaagcgactgtgtg\ncgagctgaacgggcaatgcaggaagagttctacctggaactgaaagaaggcttactggagccgctggcagtgacggaacg\ngctggccattatctcggtggtaggtgatggtatgcgcaccttgcgtgggatctcggcgaaattctttgccgcactggccc\ngcgccaatatcaacattgtcgccattgctcagggatcttctgaacgctcaatctctgtcgtggtaaataacgatgatgcg\naccactggcgtgcgcgttactcatcagatgctgttcaataccgatcaggttatcgaagtgtttgtgattggcgtcggtggGGATGAaCAGACGATGGTGCagg\ncgttggcggtgcgctgctggagcaactgaagcgtcagcaaagctggctgaagaataaacatatcgacttacgtgtctgcg\ngtgttgccaactcgaaggctctgctcaccaatgtacatggccttaatctggaaaactggcaggaagaactggcgcaagcc\naaagagccgtttaatctcgggcgcttaattcgcctcgtgaaagaatatcatctgctgaacccggtcattgttgactgcac\nttccagccaggcagtggcggatcaatatgccgacttcctgcgcgaaggtttccacgttgtcacgccgaacaaaaaggcca\nacacctcgtcgatggattactaccatcagttgcgttatgcggcggaaaaatcgcggcgtaaattcctctatgacaccaac\ngttggggctggattaccggttattgagaacctgcaaaatctgctcaatgcaggtgatgaattgatgaagttctccggcat\n>chrII\ntctttctggttcgctttcttatatcttcggcaagttagacgaaggcatgagtttctccgaggcgaccacgctggcgcggg\naaatgggttataccgaaccggacccgcgagatgatctttctggtatggatgtggcgcgtaaactattgattctcgctcgt\ngaaacgggacgtgaactggagctggcggatattgaaattgaacctgtgctgcccgcagagtttaacgccgagggtgatgt\ntgccgcttttatggcgaatctgtcacaactcgacgatctctttgccgcgcgcgtggcgaaggcccgtgatgaaggaaaag\nttttgcgctatgttggcaatattgatgaagatggcgtctgccgcgtgaagattgccgaagtggatggtaatgatccgctg\nttcaaagtgaaaaatggcgaaaacgccctggccttctatagccactattatcagccgctgccgttggtactgcgcggataGTGTACCAgAGCGGATGGTTggg\ntggtgcgggcaatgacgttacagctgccggtgtctttgctgatctgctacgtaccctctcatggaagttaggagtctgac\natggttaaagtttatgccccggcttccagtgccaatatgagcgtcgggtttgatgtgctcggggcggcggtgacacctgt\ntgatggtgcattgctcggagatgtagtcacggttgaggcggcagagacattcagtctcaacaacctcggacgctttgccg\nataagctgccgtcagaaccacgggaaaatatcgtttatcagtgctgggagcgtttttgccaggaactgggtaagcaaatt\nTATTACGCCAGCTGGCGAAAcGGgtggcgatgaccctggaaaagaatatgccgatcggttcgggcttaggctccagtgcctgttcggtggtcgcggcgct\ngatggcgatgaatgaacactgcggcaagccgcttaatgacactcgtttgctggctttgatgggcgagctggaaggccgta\ntctccggcagcattcattacgacaacgtggcaccgtgttttctcggtggtatgcagttgatgatcgaagaaaacgacatc\natcagccagcaagtgccagggtttgatgagtggctgtgggtgctggcgtatccggggattaaagtctcgacggcagaagc\ncagggctattttaccggcgcagtatcgccgccaggattgcattgcgcacgggcgacatctggcaggcttcattcacgcct\ngctattcccgtcagcctgagcttgccgcgaagctgatgaaagatgttatcgctgaaccctaccgtgaacggttactgcca\nggcttccggcaggcgcggcaggcggtcgcggaaatcggcgcggtagcgagcggtatctccggctccggcccgaccttgttCGGTAGCCAGCGCGGATCATcgg\nTATTACGCCAGCTGGCGAAAcgctctgtgtgacaagccggaaaccgcccagcgcgttgccgactggttgggtaagaactacctgcaaaatcaggaaggtt\nttgttcatatttgccggctggatacggcgggcgcacgagtactggaaaactaaatgaaactctacaatctgaaagatcac\naacgagcaggtcagctttgcgcaagccgtaacccaggggttgggcaaaaatcaggggctgttttttccgcacgacctgcc\nggaattcagcctgactgaaattgatgagatgctgaagctggattttgtcacccgcagtgcgaagatcctctcggcgttta\nttggtgatgaaatcccacaggaaatcctggaagagcgcgtgcgcgcggcgtttgccttcccggctccggtcgccaatgtt\ngaaagcgatgtcggttgtctggaattgttccacgggccaacgctggcatttaaagatttcggcggtcgctttatggcaca\naatgctgacccatattgcgggtgataagccagtgaccattctgaccgcgacctccggtgataccggagcggcagtggctc\natgctttctacggtttaccgaatgtgaaagtggttatcctctatccacgaggcaaaatcagtccactgcaagaaaaactg\nttctgtacattgggcggcaatatcgaaactgttgccatcgacggcgatttcgatgcctgtcaggcgctggtgaagcaggc\ngtttgatgatgaagaactgaaagtggcgctagggttaaactcggctaactcgattaacatcagccgtttgctggcgcagaCCGGcGCAGTATGAAGGCGGagg\ntttgctactactttgaagctgttgcgcagctgccgcaggagacgcgcaaccagctggttgtctcggtgccaagcggaaac\nttcggcgatttgacggcgggtctgctggcgaagtcactcggtctgccggtgaaacgttttattgctgcgaccaacgtgaa\ncgataccgtgccacgtttcctgcacgacggtcagtggtcacccaaagcgactcaggcgacgttatccaacgcgatggacg\n>chrIII\natgccggagaacttcatcaattcatcacctgcattgagcagattttgcaggttctcaataaccggtaatccagccccaac\ngttggtgtcatagaggaatttacgccgcgatttttccgccgcataacgcaactgatggtagtaatccatcgacgaggtgt\ntggcctttttgttcggcgtgacaacgtggaaaccttcgcgcaggaagtcggcatattgatccgccactgcctggctggaa\ngtgcagtcaacaatgaccgggttcagcagatgatattctttcacgaggcgaattaagcgcccgagattaaacggctctttccgCCTTTCGgCtCCTGGCGtAA\nggcttgcgccagttcttcctgccagttttccagattaaggccatgtacattggtgagcagagccttcgagttggcaacac\ncgcagacacgtaagtcgatatgtttattcttcagccagctttgctgacgcttcagttgctccagcagcgcaccgccaacg\nccaccgacgccaatcacaaacacttcgataacctgatcggtattgaacagcatctgatgagtaacgcgcacgccagtggt\ncgcatcatcgttatttaccacgacagagattgagcgttcagaagatccctgagcaatggcgacaatgttgatattggcgc\ngggccagtgcggcaaagaatttcgccgagatcccacgcaaggtgcgcataccatcacctaccaccgagataatggccagc\ncgttccgtcactgccagcggctccagtaagccttctttcagttccaggtagaactcttcctgcattgcccgttcagctcg\ncacacagtcgctttgtggaacgcagaaactgatgctgtattcggaagatgattgcgtaatcagcaccacggaaatacggg\ncgcgtgacatcgctgcaaagacgcgcgccgccatgccgaccatccctttcatccccggaccagaaacgctgaacattgcc\natgttattcagattggaaatgcccttgaccggtaattcgtcttcatcacggctggcaccaatgagcgtacctggtgcttg\naggatttccggtatttttaatcaggcaagggatctggaactgggcgatgggggtaatggtgcgggggtgaagaactttag\ncgccgaagtaggaaagctccatcgcttcctggtaggacatcgacttcaacaacctcgcatcgggcacctgacgcgggtcg\ncaggtatagaccccgtcaacgtccgtccaaatctcgcaacaatcggcgcgtaaacaggcagccagcaccgcagcagagta\ngtcggaaccgttgcgtccaagcaccaccagttcgcctttttcattaccggcggtgaaacctgccatcagcaccatgtgat\ncagccggaatgcggcttgccgcaatacggcgggtggactcagcaatatcgacggtagattcgaggtaatgccccactgcc\nagcagtttttcgaccggatcgataacagtaacgttgtgaccgcgcgcttctaatacgccggccataatggcgatcgacat\ntttctcgccacggcaaatcagcgcagcgttgatgctatccgggcactgccccaacaaactaatgccatgcaggacatgtt\nttatttgggcaaattcctgatcgacgaaagttttcaattgcgccagcgggaaccccggctgggcggcggcgagtcccgtc\naaaagttcggcaaaaatacgttcggcatcgctgatattgggtaaagcatcctggccgctaatggttttttcaatcatcgc\ncaccaggtggttggtgattttggcgggggcagagaggacggtggccacctgcccctgcctggcattgctttccagaatat\ncggcaacacgcagaaaacgttctgcatttgccactgatgtaccgccgaacttcaacactcgcatggttgttacctcgtta\ncctttggtcgaaaaaaaaagcccgcactgtcaggtgcgggcttttttctgtgtttcctgtacgcgtcagcccgcaccgtt\nacctgtggtaatggtgatggtggtggtaatggtggtgctaatgcgtttcatggatgttgtgtactctgtaatttttatct\ngtctgtgcgctatgcctatattggttaaagtatttagtgacctaagtcaataaaattttaatttactcacggcaggtaac\ncagttcagaagctgctatcagacactctttttttaatccacacagagacatattgcccgttgcagtcagaatgaaaagct\n>chrIV\ncgtccatcgcgttggataacgtcgcctgagtcgctttgggtgaccactgaccgtcgtgcaggaaacgtggcacggtatcg\nttcacgttggtcgcagcaataaaacgtttcaccggcagaccgagtgacttcgccagcagacccgccgtcaaatcgccgaa\ngtttccgcttggcaccgagacaaccagctggttgcgcgtctcctgcggcagctgcgcaacagcttcaaagtagtagcaaa\ntctgcgccagcaaacggctgatgttaatcgagttagccgagtttaaccctagcgccactttcagttcttcatcatcaaac\ngcctgcttcaccagcgcctgacaggcatcgaaatcgccgtcgatggcaacagtttcgatattgccgcccaatgtacagaa\ncagtttttcttgcagtggactgattttgcctcgtggatagaggataaccactttcacattcggtaaaccgtagaaagcat\ngagccactgccgctccggtatcaccggaggtcgcggtcagaatggtcactggcttatcacccgcaatatgggtcagcatt\ntgtgccataaagcgaccgccgaaatctttaaatgccagcgttggcccgtggaacaattccagacaaccgacatcgctttc\naacattggcgaccggagccgggaaggcaaacgccgcgcgcacgcgctcttccaggatttcctgtgggatttcatcaccaa\ntaaacgccgagaggatcttcgcactgcgggtgacaaaatccagcttcagcatctcatcaatttcagtcaggctgaattcccccAACCATCCGCTcTGGTACAC\nggcaggtcgtgcggaaaaaacagcccctgatttttgcccaacccctgggttacggcttgcgcaaagctgacctgctcgtt\ngtgatctttcagattgtagagtttcatttagttttccagtactcgtgcgcccgccgtatccagccggcaaatatgaacaa\naaccttcctgattttgcaggtagttcttacccaaccagtcggcaacgcgctgggcggtttccggcttgtcacacagagcg\naacaaggtcgggccggagccggagataccgctcgctaccgcgccgatttccgcgaccgcctgccgcgcctgccggaagcc\ntggcagtaaccgttcacggtagggttcagcgataacatctttcatcagcttcgcggcaagctcaggctgacgggaatagc\naggcgtgaatgaagcctgccagatgtcgcccgtgcgcaatgcaatcctggcggcgatactgcgccggtaaaatagccctg\ngcttctgccgtcgagactttaatccccggatacgccagcacccacagccactcatcaaaccctggcacttgctggctgat\ngatgtcgttttcttcgatcatcaactgcataccaccgagaaaacacggtgccacgttgtcgtaatgaatgctgccggaga\ntacggccttccagctcgcccatcaaagccagcaaacgagtgtcattaagcggcttgccgcagtgttcattcatcgccatc\nagcgccgcgaccaccgaacaggcactggagcctaagcccgaaccgatcggcatattcttttccagggtcatcgccactgg\naatttgcttacccagttcctggcaaaaacgctcccagcactgataaacgatattttcccgtggttctgacggcagcttat\ncggcaaagcgtccgaggttgttgagactgaatgtctctgccgcctcaaccgtgactacatctccgagcaatgcaccatca\nacaggtgtcaccgccgccccgagcacatcaaacccgacgctcatattggcactggaagccggggcataaactttaaccat\ngtcagactcctaacttccatgagagggtacgtagcagatcagcaaagacaccggcagctgtaacgtcattgcccgcacca\ntatccgcgcagtaccaacggcagcggctgataatagtggctatagaaggccagggcgttttcgccatttttcactttgaa\ncagcggatcattaccatccacttcggcaatcttcacgcggcagacgccatcttcatcaatattgccaacatagcgcaaaa\ncttttccttcatcacgggccttcgccacgcgcgcggcaaagagatcgtcgagttgtgacagattcgccataaaagcggca\nacatcaccctcggcgttaaactctgcgggcagcacaggttcaatttcaatatccgccagctccagttcacgtcccgtttc\nacgagcgagaatcaatagtttacgcgccacatccataccagaaagatcatctcgcgggtccggttcggtataacccattt\nTTACGCCAGCTGGCGAAAGGcGGgcgccagcgtggtcgcctcggagaaactcatgccttcgtctaacttgccgaagatataagaaagcgaaccagaaaga\n';
let unittestPAM = {
  tpam : new RegExp('\\wGG', 'i'),
  tpamr : new RegExp('CC\\w', 'i')
};

QUnit.module("test-basic-function",function(){

  QUnit.test( "test-trans-Strand", function( assert ) {
    let tseq=transStrand("ATCG");
    assert.ok( tseq == "CGAT", "tranStrand function, passed!" );
  });

  QUnit.test( "test-change-label", function( assert ) {
    let t=changeLabel("A[TG,CTG,A]TG", 3, '<strong>(c->t)</strong>', new RegExp('[ATCG]'));
    assert.ok( t == "A[TG,<strong>(c->t)</strong>TG,A]TG", "changeLabel function, passed!" );
  });

  QUnit.test( "test-add-label", function( assert ) {
    let t=addLabel("ATG,CTG,ATG", 1, '{', new RegExp('[ATCG]'));
    t=addLabel(t, 1, '[', new RegExp('[ATCG]'));
    t=addLabel(t, 7, ']', new RegExp('[ATCG]'));
    t=addLabel(t, 9, '}', new RegExp('[ATCG]'));
    assert.ok( t == "A{[TG,CTG,A]TG}", "addLabel function, passed!" );
  });

  QUnit.test( "test-spCodon", function( assert ) {
    let t1=spCodon("ATG",1,'b','[');
    t1=spCodon(t1,3,'e',']');
    let t2=spCodon("<strong>CTG</strong>",1,'b','[');
    t2=spCodon(t2,3,'e',']');
    assert.ok(t1 == '[ATG]',"spCodon function, simple codon, passed!" )
    assert.ok(t2 == '<strong>[CTG]</strong>',"spCodon2 function, with labeled, passed!" )
  });

  QUnit.test( "test-changeCondonStrSingle", function( assert ) {
    let t1=changeCondonStrSingle("ATG",1,'T');
    let t2=changeCondonStrSingle("ATG",2,'A');
    let t3=changeCondonStrSingle("ATG",3,'A');
    assert.ok(t1 == 'TTG', "pos1, passed!");
    assert.ok(t2 == 'AAG', "pos2, passed!");
    assert.ok(t3 == 'ATA', "pos3, passed!");
    assert.ok( (t1 == 'TTG') && (t2 == 'AAG') && (t3 == 'ATA'), "changeCondonStrSingle function, passed!" );
  });

});



QUnit.module("test-CBEI-ORF-finder",function(){

  QUnit.test( "test-initiaCDS-value", function( assert ) {
    assert.ok($("#PAMValue1").val() == 'NGG');
    demoSeq();
    let $cds=getCDS();
    let $target={
      seq:[unittestdemoSeq],
      seqName:['>lacZ']
    };
    assert.deepEqual($cds,$target,'initiaCDS & getCDS function pass');
  });

  QUnit.test( "test-StartEndRegx", function( assert ) {
    setORFAtgTgaCodons('selectGenetic');
    let t=getAUGreg();
    $("input[name='augcodons']:checked").each(function (){
      assert.ok($(this).val() == 'ATG');
   });
   assert.deepEqual(t,{
    augReg: new RegExp('ATG','i'),
    tgaReg: new RegExp('TAA|TAG|TGA','i')
   },"Start and stop codon regular expressions, passed!")

  });

  QUnit.test( "test-orfFinder", function( assert ) {
    let $target={
      seq:[unittestdemoSeq],
      seqName:['>lacZ']
    };
    
    let t=ORFfinderATG($target,75,new RegExp('ATG','i'),new RegExp('TAA|TAG|TGA','i'),[],'>lacZ');
    assert.ok(t.length == 20, 'ORFfinder target length, passed');
    assert.deepEqual(t[0],{
      beg:1,
      end:3075,
      fasta: ">lacZ",
      label: "+1",
      name: "ORF1",
      seq: unittestdemoSeq
    },'longest ORF finder, passed!');
    let countDict={
      '+1':0,
      '+2':0,
      '+3':0,
      '-1':0,
      '-2':0,
      '-3':0
    };
    for (let i of t){
      countDict[i.label]++;
    }
    assert.deepEqual(countDict,{
      '+1': 1,
      '+2': 6,
      '+3': 2,
      '-1': 7,
      '-2': 3,
      '-3': 1
    }, "ORF finder details, passed!");
  });

});


QUnit.module("test-CBEI-design",function(){

  QUnit.test( "test-getRegPAM", function( assert ) {
    let t=getRegPAM("NGG");
    assert.deepEqual(t,{
      len: 3,
      tpam: '\\wGG',
      tpamr: 'CC',
    },"pam NGG to Reg, OK");
    t=getRegPAM("NG");
    assert.deepEqual(t,{
      len: 2,
      tpam: '\\wG',
      tpamr: 'C',
    },"pam NG to Reg, OK");
    t=getRegPAM("NGAN");
    assert.deepEqual(t,{
      len: 4,
      tpam: '\\wGA\\w',
      tpamr: 'TC',
    },"pam NGAN to Reg, OK");
    t=getRegPAM("NGCG");
    assert.deepEqual(t,{
      len: 4,
      tpam: '\\wGCG',
      tpamr: 'CGC',
    },"pam NGCG to Reg, OK");
    t=getRegPAM("NNGRRT");
    assert.deepEqual(t,{
      len: 6,
      tpam: '\\w\\wG[AGR][AGR]T',
      tpamr: 'AC',
    },"pam NNGRRT to Reg, OK");
    t=getRegPAM("TTTV");
    assert.deepEqual(t,{
      len: 4,
      tpam: 'TTT[GACRSMV]',
      tpamr: 'AAA',
    },"pam TTTV to Reg, OK");
  });

  QUnit.test( "test-regPosNGG", function( assert ) {
    let temp = new RegExp(getRegPAM('NGG').tpam, "ig");
    let pamPos=new Array();
    let pamPosR=new Array();
    while ((temp.exec(unittestdemoSeq) !== null)) {
      pamPos.push(temp.lastIndex);
      temp.lastIndex = temp.lastIndex - 3 + 1;
    }
    assert.ok( pamPos.length == 209, "NGG reg + strand position, passed!" );

    let orfSeqM = transStrand(unittestdemoSeq);
    while ((temp.exec(orfSeqM) !== null)) {
      pamPosR.push(temp.lastIndex);
      temp.lastIndex = temp.lastIndex - 3 + 1;
    }
    assert.ok( pamPosR.length == 207, "NGG reg - strand position, passed!" );
  });

  QUnit.test( "test-regPosTTTV", function( assert ) {
    let temp = new RegExp(getRegPAM('TTTV').tpam, "ig");
    let pamPos=new Array();
    let pamPosR=new Array();
    while ((temp.exec(unittestdemoSeq) !== null)) {
      pamPos.push(temp.lastIndex);
      temp.lastIndex = temp.lastIndex - 3 + 1;
    }
    assert.ok( pamPos.length == 37, "TTTV reg + strand position, passed!" );
    assert.deepEqual(pamPos,[36, 102, 184, 193, 343, 385, 433, 454, 504, 517, 534, 630, 678, 697, 708, 779, 783, 825, 999, 1156, 1502, 1577, 1610, 1650, 1672, 1689, 1780, 1828, 1884, 1896, 2246, 2278, 2296, 2300, 2554, 2749, 2970]);
    let orfSeqM = transStrand(unittestdemoSeq);
    while ((temp.exec(orfSeqM) !== null)) {
      pamPosR.push(temp.lastIndex);
      temp.lastIndex = temp.lastIndex - 3 + 1;
    }
    assert.ok( pamPosR.length == 34, "TTTV reg - strand position, passed!" );
    assert.deepEqual(pamPosR,[9, 168, 273, 363, 389, 486, 514, 535, 757, 843, 903, 1045, 1173, 1214, 1335, 1345, 1423, 1513, 1525, 1648, 1827, 2061, 2163, 2179, 2187, 2244, 2283, 2412, 2425, 2532, 2682, 2810, 2862, 3024]);
  });

  QUnit.test( "test-calplusNNGRRT", function( assert ) {
    let infoDraw=[27, "NNGRRT", "NNCYYA", 22, 3, 12, "+"];
    let pamPos=[8, 168, 175];
    let endReg = new RegExp(/cag|caa|cga/, 'i');

    let plusStrand = calPlusStrand(unittestdemoSeq, infoDraw, pamPos, endReg, "Plus");
    assert.ok( plusStrand.length == 2, "callplus function,NNGRRT, passed!" );
    assert.deepEqual(plusStrand,[
      ["CTGAAT",
      "163-168",
      "Plus",
      '<STRONG>{</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(102,205,0,0.3);">CC<STRONG>[</STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;">T,TCC,<STRONG STYLE="COLOR: CRIMSON">(C->T)</STRONG>AA,<STRONG STYLE="COLOR: CRIMSON">(C->T)</STRONG>AG</SPAN><STRONG>]</STRONG>,TTG,CGC,AGC</SPAN><STRONG>}|</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(72,118,255,0.6);">,CTGAAT</SPAN>',
      "142-162",
      '</STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;">T,TCC,<STRONG STYLE="COLOR: CRIMSON">C</STRONG>AA,<STRONG STYLE="COLOR: CRIMSON">C</STRONG>AG</SPAN><STRONG>',
      "144-153",
      "atlas",
      "148,151",
      "CC,AC",
      0.04813008130081301,
      '</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(102,205,0,0.3);">CC<STRONG></STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;">TTCC<STRONG STYLE="COLOR: CRIMSON">C</STRONG>AA<STRONG STYLE="COLOR: CRIMSON">C</STRONG>AG</SPAN><STRONG></STRONG>TTGCGCAGC</SPAN><STRONG>',
      "CCTTCCCAACAGTTGCGCAGC"],
      [
        'GCGAAT',
        '170-175',
        'Plus',
        'C<STRONG>{</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(102,205,0,0.3);">AA,<STRONG>[</STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;"><STRONG STYLE="COLOR: CRIMSON">(C->T)</STRONG>AG,TTG,CGC,A</SPAN><STRONG>]</STRONG>GC,CTG,AAT,G</SPAN><STRONG>}|</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(72,118,255,0.6);">GC,GAAT</SPAN>',
        '149-169',
        '</STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;"><STRONG STYLE="COLOR: CRIMSON">C</STRONG>AG,TTG,CGC,A</SPAN><STRONG>',
        '151-160',
        'atlas',
        '151',
        'AC',
        0.049105691056910566,
        '</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(102,205,0,0.3);">AA<STRONG></STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;"><STRONG STYLE="COLOR: CRIMSON">C</STRONG>AGTTGCGCA</SPAN><STRONG></STRONG>GCCTGAATG</SPAN><STRONG>',
        'AACAGTTGCGCAGCCTGAATG'
      ]
    ], "CBEI predict NNGRRT details, pass");
  });

  QUnit.test( "test-calplusTTTV", function( assert ) {
    let infoDraw=[27, "TTTV", "CCCB", 1, 10, 12, "-"];
    let pamPos=[36, 102, 184, 193, 343, 385, 433, 454, 504, 517, 534, 630, 678, 697, 708, 779, 783, 825, 999, 1156, 1502, 1577, 1610, 1650, 1672, 1689, 1780, 1828, 1884, 1896, 2246, 2278, 2296, 2300, 2554, 2749, 2970];
    let endReg = new RegExp(/cag|caa|cga/, 'i');

    let plusStrand = calPlusStrand(unittestdemoSeq, infoDraw, pamPos, endReg, "Plus");
    assert.ok( plusStrand.length == 0, "callplus function,TTTV, no result, passed!" );
  });

  QUnit.test( "test-calplusNGG", function( assert ) {
    let infoDraw=[23, "NGG", "NCC", 21, 4, 8, "+"];
    let pamPos=[16, 25, 51, 52, 62, 111, 127, 170, 177, 189, 196];
    let endReg = new RegExp(/cag|caa|cga/, 'i');

    let plusStrand = calPlusStrand(unittestdemoSeq, infoDraw, pamPos, endReg, "Plus");
    assert.ok( plusStrand.length == 2, "callplus function,NGG, passed!" );
    assert.deepEqual(plusStrand,[
      ['GGG',
      '50-52',
      'Plus',
      'GT<STRONG>{</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(102,205,0,0.3);">C,GT<STRONG>[</STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;">T,TTA,<STRONG STYLE="COLOR: CRIMSON">(C->T)</STRONG></SPAN><STRONG>]</STRONG>AA,CGT,CGT,GAC,T</SPAN><STRONG>}|</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(72,118,255,0.6);">GG,G</SPAN>',
      '30-49',
      '</STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;">T,TTA,<STRONG STYLE="COLOR: CRIMSON">C</STRONG></SPAN><STRONG>',
      '33-37',
      'atlas',
      '37',
      'AC',
      0.012032520325203253,
      '</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(102,205,0,0.3);">CGT<STRONG></STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;">TTTA<STRONG STYLE="COLOR: CRIMSON">C</STRONG></SPAN><STRONG></STRONG>AACGTCGTGACT</SPAN><STRONG>',
      'CGTTTTACAACGTCGTGACT'],
      [
        'TGG',
      '168-170',
      'Plus',
      '<STRONG>{</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(102,205,0,0.3);">CAA,<STRONG>[</STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;"><STRONG STYLE="COLOR: CRIMSON">(C->T)</STRONG>AG,TT</SPAN><STRONG>]</STRONG>G,CGC,AGC,CTG,AA</SPAN><STRONG>}|</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(72,118,255,0.6);">T,GG</SPAN>',
      '148-167',
      '</STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;"><STRONG STYLE="COLOR: CRIMSON">C</STRONG>AG,TT</SPAN><STRONG>',
      '151-155',
      'atlas',
      '151',
      'AC',
      0.049105691056910566,
      '</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(102,205,0,0.3);">CAA<STRONG></STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;"><STRONG STYLE="COLOR: CRIMSON">C</STRONG>AGTT</SPAN><STRONG></STRONG>GCGCAGCCTGAA</SPAN><STRONG>',
      'CAACAGTTGCGCAGCCTGAA'
      ]
    ], "CBEI predict NGG details, pass");
  });

  QUnit.test( "test-calMinusNNGRRT", function( assert ) {
    let infoDraw=[27, "NNGRRT", "NNCYYA", 22, 3, 12, "+"];
    let pamPosR=[55, 83, 294, 356, 440, 668, 678, 720, 864, 994, 1180, 1232];
    let endRegm = new RegExp(/cca/, 'i');

    let minusStrand = calPlusStrand(transStrand(unittestdemoSeq), infoDraw, pamPosR, endRegm, "Minus");
    assert.ok( minusStrand.length == 2, "callplus function,NNGRRT, passed!" );
    assert.deepEqual(minusStrand,[
      ['TAGGGT',
      '2413-2408',
      'Minus',
      'CT<STRONG>{</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(102,205,0,0.3);">T,C<STRONG>[</STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;"><STRONG STYLE="COLOR: CRIMSON">(C->T)</STRONG>A,GCG,TTC,GA</SPAN><STRONG>]</STRONG>C,CCA,GGC,GT</SPAN><STRONG>}|</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(72,118,255,0.6);">T,AGGGT</SPAN>',
      '2434-2414',
      '</STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;"><STRONG STYLE="COLOR: CRIMSON">C</STRONG>A,GCG,TTC,GA</SPAN><STRONG>',
      '2432-2423',
      'atlas',
      '2432',
      'CC',
      0.7908943089430894,
      '</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(102,205,0,0.3);">TC<STRONG></STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;"><STRONG STYLE="COLOR: CRIMSON">C</STRONG>AGCGTTCGA</SPAN><STRONG></STRONG>CCCAGGCGT</SPAN><STRONG>',
      'TCCAGCGTTCGACCCAGGCGT'
      ],
      [
      'GCGGGT',
      '2403-2398',
      'Minus',
      '<STRONG>{</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(102,205,0,0.3);">GA<STRONG>[</STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;">C,<STRONG STYLE="COLOR: CRIMSON">(C->T)</STRONG><STRONG STYLE="COLOR: CRIMSON">(C->T)</STRONG>A,GGC,GTT</SPAN><STRONG>]</STRONG>,AGG,GTC,AAT</SPAN><STRONG>}|</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(72,118,255,0.6);">,GCGGGT</SPAN>',
      '2424-2404',
      '</STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;">C,<STRONG STYLE="COLOR: CRIMSON">C</STRONG><STRONG STYLE="COLOR: CRIMSON">C</STRONG>A,GGC,GTT</SPAN><STRONG>',
      '2422-2413',
      'atlas',
      '2421,2420',
      'CC,CC',
      0.7873170731707317,
      '</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(102,205,0,0.3);">GA<STRONG></STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;">C<STRONG STYLE="COLOR: CRIMSON">C</STRONG><STRONG STYLE="COLOR: CRIMSON">C</STRONG>AGGCGTT</SPAN><STRONG></STRONG>AGGGTCAAT</SPAN><STRONG>',
      'GACCCAGGCGTTAGGGTCAAT'
      ]
    ], "CBEI predict minus, NNGRRT details, pass");
  });
  
  QUnit.test( "test-calMinusTTTV", function( assert ) {
    let infoDraw=[27, "TTTV", "CCCB", 1, 10, 12, "-"];
    let pamPosR=[389, 486, 514, 535, 757, 843];
    let endRegm = new RegExp(/cca/, 'i');

    let minusStrand = calPlusStrand(transStrand(unittestdemoSeq), infoDraw, pamPosR, endRegm, "Minus");
    assert.ok( minusStrand.length == 2, "callplus function,NNGRRT, passed!" );
    assert.deepEqual(minusStrand,[
      [
        'TTTC',
        '2544-2541',
        'Minus',
        '<SPAN STYLE="BACKGROUND-COLOR: RGBA(72,118,255,0.6);">TTT,C</SPAN><STRONG>|{</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(102,205,0,0.3);">CC,CTG,ATG,C<STRONG>[</STRONG><SPAN STYLE="BACKGROUND-COLOR:WHEAT;">TG,<STRONG STYLE="COLOR: CRIMSON">(C->T)</STRONG></SPAN><STRONG>]</STRONG>CA,CGC,GTG,AGC</SPAN><STRONG>}</STRONG>',
        '2540-2518',
        '</STRONG><SPAN STYLE="BACKGROUND-COLOR:WHEAT;">TG,<STRONG STYLE="COLOR: CRIMSON">C</STRONG></SPAN><STRONG>',
        '2531-2529',
        'atlas',
        '2529',
        'GC',
        0.8224390243902439,
        '</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(102,205,0,0.3);">CCCTGATGC<STRONG></STRONG><SPAN STYLE="BACKGROUND-COLOR:WHEAT;">TG<STRONG STYLE="COLOR: CRIMSON">C</STRONG></SPAN><STRONG></STRONG>CACGCGTGAGC</SPAN><STRONG>',
        'CCCTGATGCTGCCACGCGTGAGC'
      ],
      [
        'TTTA',
        '2322-2319',
        'Minus',
        '<SPAN STYLE="BACKGROUND-COLOR: RGBA(72,118,255,0.6);">TTT,A</SPAN><STRONG>|{</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(102,205,0,0.3);">TC,GCC,AAT,C<STRONG>[</STRONG><SPAN STYLE="BACKGROUND-COLOR:WHEAT;"><STRONG STYLE="COLOR: CRIMSON">(C->T)</STRONG>A,C</SPAN><STRONG>]</STRONG>AT,CTG,TGA,AAG</SPAN><STRONG>}</STRONG>',
        '2318-2296',
        '</STRONG><SPAN STYLE="BACKGROUND-COLOR:WHEAT;"><STRONG STYLE="COLOR: CRIMSON">C</STRONG>A,C</SPAN><STRONG>',
        '2309-2307',
        'atlas',
        '2309',
        'CC',
        0.7508943089430894,
        '</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(102,205,0,0.3);">TCGCCAATC<STRONG></STRONG><SPAN STYLE="BACKGROUND-COLOR:WHEAT;"><STRONG STYLE="COLOR: CRIMSON">C</STRONG>AC</SPAN><STRONG></STRONG>ATCTGTGAAAG</SPAN><STRONG>',
        'TCGCCAATCCACATCTGTGAAAG'
      ]
    ], "CBEI predict minus, TTTV details, pass");
  });

  QUnit.test( "test-calMinusNGG", function( assert ) {
    let infoDraw=[23, "NGG", "NCC", 21, 4, 8, "+"];
    let pamPosR=[2934,2935,2942,2947,2948,2972,2979,2980,2981,2982];
    let endRegm = new RegExp(/cca/, 'i');

    let minusStrand = calPlusStrand(transStrand(unittestdemoSeq), infoDraw, pamPosR, endRegm, "Minus");
    assert.ok( minusStrand.length == 3, "callplus function,NNGRRT, passed!" );
    assert.deepEqual(minusStrand,[
      [
        'GGG',
        '98-96',
        'Minus',
        'GC<STRONG>{</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(102,205,0,0.3);">T,AT<STRONG>[</STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;">T,ACG,<STRONG STYLE="COLOR: CRIMSON">(C->T)</STRONG></SPAN><STRONG>]</STRONG>CA,GCT,GGC,GAA,A</SPAN><STRONG>}|</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(72,118,255,0.6);">GG,G</SPAN>',
        '118-99',
        '</STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;">T,ACG,<STRONG STYLE="COLOR: CRIMSON">C</STRONG></SPAN><STRONG>',
        '115-111',
        'atlas',
        '111',
        'GC',
        0.03609756097560975,
        '</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(102,205,0,0.3);">TAT<STRONG></STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;">TACG<STRONG STYLE="COLOR: CRIMSON">C</STRONG></SPAN><STRONG></STRONG>CAGCTGGCGAAA</SPAN><STRONG>',
        'TATTACGCCAGCTGGCGAAA'
      ],
      [
        'GGG',
        '97-95',
        'Minus',
        '<STRONG>{</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(102,205,0,0.3);">ATT,<STRONG>[</STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;">ACG,<STRONG STYLE="COLOR: CRIMSON">(C->T)</STRONG><STRONG STYLE="COLOR: CRIMSON">(C->T)</STRONG></SPAN><STRONG>]</STRONG>A,GCT,GGC,GAA,AG</SPAN><STRONG>}|</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(72,118,255,0.6);">G,GG</SPAN>',
        '117-98',
        '</STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;">ACG,<STRONG STYLE="COLOR: CRIMSON">C</STRONG><STRONG STYLE="COLOR: CRIMSON">C</STRONG></SPAN><STRONG>',
        '114-110',
        'atlas',
        '111,110',
        'GC,CC',
        0.03609756097560975,
        '</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(102,205,0,0.3);">ATT<STRONG></STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;">ACG<STRONG STYLE="COLOR: CRIMSON">C</STRONG><STRONG STYLE="COLOR: CRIMSON">C</STRONG></SPAN><STRONG></STRONG>AGCTGGCGAAAG</SPAN><STRONG>',
        'ATTACGCCAGCTGGCGAAAG'
      ],
      [
        'GGG',
        '96-94',
        'Minus',
        'A<STRONG>{</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(102,205,0,0.3);">TT,A<STRONG>[</STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;">CG,<STRONG STYLE="COLOR: CRIMSON">(C->T)</STRONG><STRONG STYLE="COLOR: CRIMSON">(C->T)</STRONG>A</SPAN><STRONG>]</STRONG>,GCT,GGC,GAA,AGG</SPAN><STRONG>}|</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(72,118,255,0.6);">,GGG</SPAN>',
        '116-97',
        '</STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;">CG,<STRONG STYLE="COLOR: CRIMSON">C</STRONG><STRONG STYLE="COLOR: CRIMSON">C</STRONG>A</SPAN><STRONG>',
        '113-109',
        'atlas',
        '111,110',
        'GC,CC',
        0.03609756097560975,
        '</STRONG><SPAN STYLE="BACKGROUND-COLOR: RGBA(102,205,0,0.3);">TTA<STRONG></STRONG><SPAN STYLE="BACKGROUND-COLOR: WHEAT;">CG<STRONG STYLE="COLOR: CRIMSON">C</STRONG><STRONG STYLE="COLOR: CRIMSON">C</STRONG>A</SPAN><STRONG></STRONG>GCTGGCGAAAGG</SPAN><STRONG>',
        'TTACGCCAGCTGGCGAAAGG'
      ]
    ], "CBEI predict minus, NGG details, pass");
  });
});

QUnit.module("test-offtarget-function",function(){
  QUnit.test( "test-getSpacer", function( assert ) {
    demoSpacerSeq();
    let t=getSpacerText("spacerSequence2");
    assert.deepEqual(t,["TTACGCCAGCTGGCGAAAGG", "TATTACGCCAGCTGGCGAAA", "CAACAGTTGCGCAGCCTGAA", "CAAAGCGCCATTCGCCATTC", "CAGACGCGAATTATTTTTGA", "TTTATGGCAGGGTGAAACGC", "GGATGAGCAGACGATGGTGC", "GTGTACCACAGCGGATGGTT", "GCGACCAGATGATCACACTC", "CCGGTGCAGTATGAAGGCGG"],"demo spacer, passed");
  });

  QUnit.test( "test-fasta-trimmed", function( assert ) {
    let t=fastaTrim(testFasta);
    assert.ok(t.length==4);
    let fheader=new Array();
    for (i in t){
      fheader[i]=t[i].fasHeader;
    }
    assert.deepEqual(fheader,["chrI", "chrII", "chrIII", "chrIV"],'fasta-trimmed, pass');
  }); 

  
  QUnit.test( "test-align-mis0", function( assert ) {
    let t=fastaTrim(testFasta);
    let tspacer="TTACGCCAGCTGGCGAAAGG";
    let mis=ala0(tspacer, transStrand(tspacer),t,unittestPAM, 3, "+", 0);
    assert.ok(mis.length==1,"align-mis0 length, passed");
    assert.deepEqual(mis,[{
      header: "chrIV",
      index: 0,
      newPAM: "cGG",
      pos: 2344,
      seq: "TTACGCCAGCTGGCGAAAGG",
      strand: "+"
    }],'align-mis0 detailed, passed');
  });

  QUnit.test( "test-align-mis2", function( assert ) {
    let t=fastaTrim(testFasta);
    let tspacer="TATTACGCCAGCTGGCGAAA";
    let mis=ala0(tspacer, transStrand(tspacer),t,unittestPAM, 3, "+", 0);
    assert.ok(mis.length==2,"align-mis0-2 length, passed");
    assert.deepEqual(mis,[{
      header: "chrI",
      index: 0,
      newPAM: "aGG",
      pos: 287,
      seq: "TATTACGCCAGCTGGCGAAA",
      strand: "+",
    },{
      header: "chrII",
      index: 0,
      newPAM: "cGG",
      pos: 824,
      seq: "TATTACGCCAGCTGGCGAAA",
      strand: "+"
    }
  ],'align-mis0-2 detailed, passed');
  }); 
  
  QUnit.test( "test-align-mis1", function( assert ) {
    let t=fastaTrim(testFasta);
    let tspacer="TTACGCCAGCTGGCGAAAGG";
    let mis=alaplus(tspacer, transStrand(tspacer),t,unittestPAM, 3, "+", 0, 1);
    assert.ok(mis.length==2,"align-mis1 length, passed");
    assert.deepEqual(mis,[{
      header: "chrI",
      index: "0",
      mispos: "19,",
      newPAM: "Ggg",
      pos: "289",
      seq: "ttacgccagctggcgaaaAg",
      strand: "+"
    },{
      header: "chrIV",
      index: "0",
      mispos: "",
      newPAM: "cGG",
      pos: "2344",
      seq: "ttacgccagctggcgaaagg",
      strand: "+"
    }],'align-mis1 detailed, passed');
  });

  QUnit.test( "test-align-mis1-2", function( assert ) {
    let t=fastaTrim(testFasta);
    let tspacer="TATTACGCCAGCTGGCGAAA";
    let mis=alaplus(tspacer, transStrand(tspacer),t,unittestPAM, 3, "+", 0, 1);
    assert.ok(mis.length==2,"align-mis2 length, passed");
    assert.deepEqual(mis,[{
      header: "chrI",
      index: "0",
      mispos: "",
      newPAM: "aGG",
      pos: "287",
      seq: "tattacgccagctggcgaaa",
      strand: "+"
    },{
      header: "chrII",
      index: "0",
      mispos: "",
      newPAM: "cGG",
      pos: "824",
      seq: "tattacgccagctggcgaaa",
      strand: "+"
    }
    ],'align-mis1-2 detailed, passed');
  });

  QUnit.test( "test-align-mis2", function( assert ) {
    let t=fastaTrim(testFasta);
    let tspacer="TTACGCCAGCTGGCGAAAGG";
    let mis=alaplus(tspacer, transStrand(tspacer),t,unittestPAM, 3, "+", 0, 2);
    assert.ok(mis.length==2,"align-mis2 length, passed");
    assert.deepEqual(mis,[{
      header: "chrI",
      index: "0",
      mispos: "19,",
      newPAM: "Ggg",
      pos: "289",
      seq: "ttacgccagctggcgaaaAg",
      strand: "+"
    },{
      header: "chrIV",
      index: "0",
      mispos: "",
      newPAM: "cGG",
      pos: "2344",
      seq: "ttacgccagctggcgaaagg",
      strand: "+"
    }],'align-mis2 detailed, passed');
  });


  QUnit.test( "test-align-mis3", function( assert ) {
    let t=fastaTrim(testFasta);
    let tspacer="TTACGCCAGCTGGCGAAAGG";
    let mis=alaplus(tspacer, transStrand(tspacer),t,unittestPAM, 3, "+", 0, 3);
    assert.ok(mis.length==5,"align-mis3 length, passed");
    assert.deepEqual(mis,[{
      header: "chrI",
      index: "0",
      mispos: "10,11,13,",
      newPAM: "cgg",
      pos: "81",
      seq: "ttacgccagGAgCcgaaagg",
      strand: "+"
    },{
      header: "chrI",
      index: "0",
      mispos: "19,",
      newPAM: "Ggg",
      pos: "289",
      seq: "ttacgccagctggcgaaaAg",
      strand: "+"
    },{
      header: "chrI",
      index: "0",
      mispos: "8,10,11,",
      newPAM: "CCA",
      pos: "187",
      seq: "cctttcgGcTCctggcgtaa",
      strand: "-"
    },{
      header: "chrIII",
      index: "0",
      mispos: "8,10,11,",
      newPAM: "ccg",
      pos: "324",
      seq: "cctttcgGcTCctggcgtaa",
      strand: "-"
    },{
      header: "chrIV",
      index: "0",
      mispos: "",
      newPAM: "cGG",
      pos: "2344",
      seq: "ttacgccagctggcgaaagg",
      strand: "+"
    }],'align-mis3 detailed, passed');
  });

  QUnit.test( "test-align-mis3-2", function( assert ) {
    let t=fastaTrim(testFasta);
    let tspacer="GTGTACCACAGCGGATGGTT";
    let mis=alaplus(tspacer, transStrand(tspacer),t,unittestPAM, 3, "+", 0, 3);
    assert.ok(mis.length==2,"align-mis3-2 length, passed");
    assert.deepEqual(mis,[{
      header: "chrII",
      index: "0",
      mispos: "9,",
      newPAM: "ggg",
      pos: "481",
      seq: "gtgtaccaGagcggatggtt",
      strand: "+"
    },{
      header: "chrIV",
      index: "0",
      mispos: "12,",
      newPAM: "ccc",
      pos: "804",
      seq: "aaccatccgctCtggtacac",
      strand: "-"
    }
  ],'align-mis3-2 detailed, passed');
  });

  QUnit.test( "test-align-mis3-3", function( assert ) {
    let t=fastaTrim(testFasta);
    let tspacer="CCGGTGCAGTATGAAGGCGG";
    let mis=alaplus(tspacer, transStrand(tspacer),t,unittestPAM, 3, "+", 0, 3);
    assert.ok(mis.length==1,"align-mis3-3 length, passed");
    assert.deepEqual(mis,[{
      header: "chrII",
      index: "0",
      mispos: "5,",
      newPAM: "agg",
      pos: "2247",
      seq: "ccggCgcagtatgaaggcgg",
      strand: "+"
    }
  ],'align-mis3-3 detailed, passed');
  });

  QUnit.test( "test-align-mis3-4", function( assert ) {
    let t=fastaTrim(testFasta);
    let tspacer="CAACAGTTGCGCAGCCTGAA";
    let mis=alaplus(tspacer, transStrand(tspacer),t,unittestPAM, 3, "+", 0, 3);
    assert.ok(mis.length==1,"align-mis3-4 length, passed");
    assert.deepEqual(mis,[{
      header: "chrI",
      index: "0",
      mispos: "5,12,",
      newPAM: "tgg",
      pos: "1027",
      seq: "caacTgttgcgGagcctgaa",
      strand: "+"
    }
  ],'align-mis3-4 detailed, passed');
  });
});